import { assertEquals } from '@std/assert'
import { castFecha, createMonthsObject } from '../src/utils.ts'
import { castAdicionales } from '../src/data_parser.ts'
import type { Adicionales, Formulario } from '../src/types.ts'

import * as main from '../mod.ts'

const formulario = {
  categoria: 'CATEGORIA 4',
  antiguedad: 6,
  titulo: 'Secundario',
  permanencia: '2 a 4 a침os',
  suplementoCategoria: 'SIN SUPLEMENTO',
  apunsam: 'SI',
  horasExtraCincuenta: 0,
  horasExtraCien: 0,
  riesgofallo: 'NO',
  'a침oCalcular': '2024',
  hijos: 0,
} as Formulario

const sueldosBasicos2024 = [
  {
    'FECHA': '1/1/2024',
    'CATEGORIA 1': '811543.48',
    'CATEGORIA 2': '676287.47',
    'CATEGORIA 3': '562677.94',
    'CATEGORIA 4': '467997.46',
    'CATEGORIA 5': '389541.71',
    'CATEGORIA 6': '324613.06',
    'CATEGORIA 7': '270513.63',
  },
  {
    'FECHA': ('1/2/2024'),
    'CATEGORIA 1': '941390.44',
    'CATEGORIA 2': '784493.47',
    'CATEGORIA 3': '652706.41',
    'CATEGORIA 4': '542877.05',
    'CATEGORIA 5': '451868.38',
    'CATEGORIA 6': '376551.16',
    'CATEGORIA 7': '313795.81',
  },
  {
    'FECHA': ('1/3/2024'),
    'CATEGORIA 1': '1054358.00',
    'CATEGORIA 2': '878633.00',
    'CATEGORIA 3': '731032.00',
    'CATEGORIA 4': '608023.00',
    'CATEGORIA 5': '506093.00',
    'CATEGORIA 6': '421738.00',
    'CATEGORIA 7': '351452.00',
  },
  {
    'FECHA': ('1/4/2024'),
    'CATEGORIA 1': '1138707.00',
    'CATEGORIA 2': '948924.00',
    'CATEGORIA 3': '789515.00',
    'CATEGORIA 4': '656665.00',
    'CATEGORIA 5': '546581.00',
    'CATEGORIA 6': '455478.00',
    'CATEGORIA 7': '379569.00',
  },
  {
    'FECHA': ('1/5/2024'),
    'CATEGORIA 1': '1241190.63',
    'CATEGORIA 2': '1034327.16',
    'CATEGORIA 3': '860571.35',
    'CATEGORIA 4': '715764.85',
    'CATEGORIA 5': '595773.29',
    'CATEGORIA 6': '496471.02',
    'CATEGORIA 7': '413730.21',
  },
  {
    'FECHA': ('1/6/2024'),
    'CATEGORIA 1': '1290838.26',
    'CATEGORIA 2': '1075700.25',
    'CATEGORIA 3': '894994.21',
    'CATEGORIA 4': '744395.45',
    'CATEGORIA 5': '619604.23',
    'CATEGORIA 6': '516329.87',
    'CATEGORIA 7': '430279.42',
  },
  {
    'FECHA': ('1/7/2024'),
    'CATEGORIA 1': '1387651.13',
    'CATEGORIA 2': '1156377.77',
    'CATEGORIA 3': '962118.78',
    'CATEGORIA 4': '800225.11',
    'CATEGORIA 5': '666074.55',
    'CATEGORIA 6': '555054.62',
    'CATEGORIA 7': '462550.38',
  },
  {
    'FECHA': ('1/8/2024'),
    'CATEGORIA 1': '1429280.67',
    'CATEGORIA 2': '1191069.11',
    'CATEGORIA 3': '990982.35',
    'CATEGORIA 4': '824231.87',
    'CATEGORIA 5': '686056.79',
    'CATEGORIA 6': '571706.26',
    'CATEGORIA 7': '476426.90',
  },
  {
    'FECHA': ('1/9/2024'),
    'CATEGORIA 1': '1457866.29',
    'CATEGORIA 2': '1214890.50',
    'CATEGORIA 3': '1010802.00',
    'CATEGORIA 4': '840716.51',
    'CATEGORIA 5': '699777.93',
    'CATEGORIA 6': '583140.39',
    'CATEGORIA 7': '485955.44',
  },
  {
    'FECHA': ('1/10/2024'),
    'CATEGORIA 1': '1557001.20',
    'CATEGORIA 2': '1297503.06',
    'CATEGORIA 3': '1079536.54',
    'CATEGORIA 4': '897885.24',
    'CATEGORIA 5': '747362.83',
    'CATEGORIA 6': '622793.94',
    'CATEGORIA 7': '519000.41',
  },
  {
    'FECHA': ('1/11/2024'),
    'CATEGORIA 1': '1588141.23',
    'CATEGORIA 2': '1323453.13',
    'CATEGORIA 3': '1101127.28',
    'CATEGORIA 4': '915842.95',
    'CATEGORIA 5': '762310.09',
    'CATEGORIA 6': '635249.82',
    'CATEGORIA 7': '529380.42',
  },
  {
    'FECHA': ('1/12/2024'),
    'CATEGORIA 1': '1604022.64',
    'CATEGORIA 2': '1336687.66',
    'CATEGORIA 3': '1112138.55',
    'CATEGORIA 4': '925001.38',
    'CATEGORIA 5': '769933.19',
    'CATEGORIA 6': '641602.32',
    'CATEGORIA 7': '534674.22',
  },
]

const adicionalesDataset = [
  {
    DESDE: '02/01/2024',
    HASTA: '30/4/2024',
    CONCEPTO: 'suma fija',
    REMUNERATIVO: 'SI',
    'CATEGORIA 1': '0',
    'CATEGORIA 2': '100',
    'CATEGORIA 3': '200',
    'CATEGORIA 4': '0',
    'CATEGORIA 5': '0',
    'CATEGORIA 6': '0',
    'CATEGORIA 7': '0',
  },
  {
    DESDE: '01/05/2024',
    HASTA: '30/5/2024',
    CONCEPTO: 'suma fija',
    REMUNERATIVO: 'NO',
    'CATEGORIA 1': '0',
    'CATEGORIA 2': '100',
    'CATEGORIA 3': '200',
    'CATEGORIA 4': '0',
    'CATEGORIA 5': '0',
    'CATEGORIA 6': '0',
    'CATEGORIA 7': '0',
  },
  {
    DESDE: '01/08/2024',
    HASTA: '30/8/2024',
    CONCEPTO: 'suma fija',
    REMUNERATIVO: 'NO',
    'CATEGORIA 1': '0',
    'CATEGORIA 2': '100',
    'CATEGORIA 3': '200',
    'CATEGORIA 4': '0',
    'CATEGORIA 5': '0',
    'CATEGORIA 6': '0',
    'CATEGORIA 7': '0',
  },
]

const meses = [
  createMonthsObject('1', '2024'),
  createMonthsObject('2', '2024'),
  createMonthsObject('3', '2024'),
  createMonthsObject('4', '2024'),
  createMonthsObject('5', '2024'),
  createMonthsObject('6', '2024'),
  createMonthsObject('7', '2024'),
  createMonthsObject('8', '2024'),
  createMonthsObject('9', '2024'),
  createMonthsObject('10', '2024'),
  createMonthsObject('11', '2024'),
  createMonthsObject('12', '2024'),
]

Deno.test('C치lculo de aguinaldo (SAC) de Categoria 3', () => {
  const sac = main.calcularSac(
    formulario,
    sueldosBasicos2024,
    adicionalesDataset,
    { meses: ['7', '8', '9', '10', '11', '12'], a침o: '2024', ars: false },
  )
  console.log(sac)
  assertEquals(652766.75, sac.montoBruto)
})
